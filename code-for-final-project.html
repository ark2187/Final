<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Code for final project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">About</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="report.html">Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exploratory Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="crossings_monthly.html">Crossings Monthly</a>
    </li>
    <li>
      <a href="crossings_annually.html">Crossings Annually</a>
    </li>
    <li>
      <a href="crossings_people.html">Crossings of People</a>
    </li>
    <li>
      <a href="crossings_vehicle.html">Crossings of Vehicles, Personal, Commercial</a>
    </li>
  </ul>
</li>
<li>
  <a href="acn2138.shinyapps.io/dashboard/">Shiny App</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Code for final project</h1>
<h4 class="date">11/5/2020</h4>

</div>


<div id="reading-in-a-tidying-the-data" class="section level2">
<h2>Reading in a tidying the data</h2>
<p>Reading in the border crossing data:</p>
<ul>
<li>Time information was removed since all times were 12am and thus were not useful</li>
<li>All day information was removed because all were on the 1st of the month for each month</li>
<li>Years before 2000 were removed</li>
<li>There is an Eastport (<code>port_name</code>) in Maine and Idaho. Create a port_name_state variable instead so there is no confusion</li>
<li>Kept state variable but removed port_name– we might want to look at state alone</li>
<li>I removed 2019 because there is only data for Jan, Feb and March</li>
<li>A lot of values were equal to 0. I removed these rows since that means there were no border crossings at that time for those measure types.</li>
</ul>
<pre class="r"><code>border_crossing_df = read_csv(file = &quot;./Border_Crossing_Entry_Data.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(date = str_sub(date, end = -13), 
         location = str_replace(location, &quot;POINT &quot;, &quot;&quot;), 
         port_name_state = str_c(port_name, state, sep = &quot;_&quot;)) %&gt;% 
  separate(date, into = c(&quot;month&quot;, &quot;day&quot;, &quot;year&quot;), sep = &quot;/&quot;, convert = TRUE) %&gt;% 
  select(-day, -port_name) %&gt;% 
  separate(location, into = c(&quot;long&quot;, &quot;lat&quot;), sep = &quot; &quot;) %&gt;% 
  mutate(long = str_replace(long, &quot;\\(&quot;, &quot;&quot;), 
         lat = str_replace(lat, &quot;\\)&quot;, &quot;&quot;), 
         long = as.numeric(long),
         lat =  as.numeric(lat)) %&gt;% 
  filter(year &gt;= 2000, year &lt; 2019, value != 0)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   `Port Name` = col_character(),
##   State = col_character(),
##   `Port Code` = col_double(),
##   Border = col_character(),
##   Date = col_character(),
##   Measure = col_character(),
##   Value = col_double(),
##   Location = col_character()
## )</code></pre>
<p>Findings from tables below:</p>
<ul>
<li>Most border crossings in July/August. Summer vacations?</li>
<li>Decline in border crossings since 2000. Largest drop off after 2008. Obama admin?</li>
<li>Ohio has very few border crossings and only in 2018 (Toldeo-Sandusky Port 4105). ICE issues?</li>
<li>A lot more crossings for US-Mexico border than US-Canada border</li>
</ul>
<pre class="r"><code>## Border crossings by month 
border_crossing_df %&gt;% 
  group_by(month) %&gt;% 
  summarize(n = sum(value))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    month         n
##    &lt;int&gt;     &lt;dbl&gt;
##  1     1 611107875
##  2     2 568690871
##  3     3 651409308
##  4     4 628266842
##  5     5 658004778
##  6     6 648545701
##  7     7 714405951
##  8     8 718551827
##  9     9 623220080
## 10    10 631347754
## 11    11 612730589
## 12    12 649952890</code></pre>
<pre class="r"><code>## Border crossings by year
border_crossing_df %&gt;% 
  group_by(year) %&gt;% 
  summarize(n = sum(value))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 19 x 2
##     year         n
##    &lt;int&gt;     &lt;dbl&gt;
##  1  2000 540021542
##  2  2001 493083902
##  3  2002 475702818
##  4  2003 456392653
##  5  2004 458220298
##  6  2005 450234268
##  7  2006 440296022
##  8  2007 417587175
##  9  2008 399902033
## 10  2009 359451762
## 11  2010 344246536
## 12  2011 332226000
## 13  2012 344503916
## 14  2013 356218438
## 15  2014 363314116
## 16  2015 365219998
## 17  2016 367484183
## 18  2017 372971276
## 19  2018 379157530</code></pre>
<pre class="r"><code>## Border crossings by state
border_crossing_df %&gt;% 
  group_by(state) %&gt;% 
  summarize(n = sum(value))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 15 x 2
##    state                 n
##    &lt;chr&gt;             &lt;dbl&gt;
##  1 Alaska         11573060
##  2 Arizona       715509023
##  3 California   2056017209
##  4 Idaho          17215550
##  5 Maine         174217600
##  6 Michigan      557354352
##  7 Minnesota      77081223
##  8 Montana        43232599
##  9 New Mexico     58338762
## 10 New York      653477192
## 11 North Dakota   63229290
## 12 Ohio                373
## 13 Texas        2804141437
## 14 Vermont        91600402
## 15 Washington    393246394</code></pre>
<pre class="r"><code>## Border crossings by measure
border_crossing_df %&gt;% 
  group_by(measure) %&gt;% 
  summarize(n = sum(value))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    measure                              n
##    &lt;chr&gt;                            &lt;dbl&gt;
##  1 Bus Passengers               113548058
##  2 Buses                          6904908
##  3 Pedestrians                  859594269
##  4 Personal Vehicle Passengers 4189113375
##  5 Personal Vehicles           2068077007
##  6 Rail Containers Empty         19082028
##  7 Rail Containers Full          34186220
##  8 Train Passengers               5149980
##  9 Trains                          735791
## 10 Truck Containers Empty        54526962
## 11 Truck Containers Full        154262783
## 12 Trucks                       211053085</code></pre>
<pre class="r"><code>## Border crossings by port
border_crossing_df %&gt;% 
  group_by(port_name_state) %&gt;% 
  summarize(n = sum(value)) %&gt;% 
  arrange(desc(n))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 117 x 2
##    port_name_state                        n
##    &lt;chr&gt;                              &lt;dbl&gt;
##  1 San Ysidro_California          961771552
##  2 El Paso_Texas                  879953412
##  3 Laredo_Texas                   514981282
##  4 Buffalo-Niagara Falls_New York 426670702
##  5 Hidalgo_Texas                  421612662
##  6 Brownsville_Texas              403087196
##  7 Otay Mesa_California           383875040
##  8 Calexico_California            380156649
##  9 Detroit_Michigan               353224718
## 10 Nogales_Arizona                323086640
## # ... with 107 more rows</code></pre>
<pre class="r"><code>## Border crossings by border 
border_crossing_df %&gt;% 
  group_by(border) %&gt;% 
  summarize(n = sum(value))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 2 x 2
##   border                    n
##   &lt;chr&gt;                 &lt;dbl&gt;
## 1 US-Canada Border 2082228035
## 2 US-Mexico Border 5634006431</code></pre>
<p>Potential Visuals:</p>
<ul>
<li>I think we can make some of these interactive in the shiny app. For example, we can set year as an input option for the drop down menu or measure type or state</li>
</ul>
<pre class="r"><code>## Boxplot

#Just look at 2018 and personal vehicles for example here

border_crossing_df %&gt;%
  filter(year == 2018, measure == &quot;Personal Vehicles&quot;) %&gt;%
  group_by(month) %&gt;% 
  ggplot(aes(x = as.factor(month), y = value)) + 
  geom_boxplot() + 
  labs(title = &quot;Personal Vehicle Crossings in 2018 by Month&quot;,
       x = &quot;Month&quot;, 
       y = &quot;Number of Crossings&quot;)</code></pre>
<p><img src="code-for-final-project_files/figure-html/potential_visuals-1.png" width="672" /></p>
<pre class="r"><code>## Bar plot

border_crossing_df %&gt;%
  group_by(month, border) %&gt;% 
  summarize(n = sum(value)) %&gt;% 
  ggplot(aes(x = as.factor(month), y = n, fill = border)) + 
  geom_bar(stat = &quot;identity&quot;, position = &#39;dodge&#39;) + 
  labs(title = &quot;Crossings by Month and Border&quot;,
       x = &quot;Month&quot;, 
       y = &quot;Number of Crossings&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;month&#39; (override with `.groups` argument)</code></pre>
<p><img src="code-for-final-project_files/figure-html/potential_visuals-2.png" width="672" /></p>
<pre class="r"><code>## Average values over time for top 3 states in 2018
border_crossing_df %&gt;%
  filter(state %in% c(&quot;Texas&quot;, &quot;California&quot;, &quot;Arizona&quot;, &quot;New York&quot;, &quot;Michigan&quot;), year == 2018) %&gt;% 
  group_by(state, month, year) %&gt;%  
  summarize(mean_value = mean(value)) %&gt;%
  ggplot(aes(x = month , y = mean_value, color = state)) + 
  geom_point() + 
  geom_line() + 
  theme(legend.position = &quot;bottom&quot;) + 
  scale_x_continuous(limits = c(1,12), breaks = c(1:12)) +
  labs(title = &quot;Average Number of Border Crossings Over Time by State&quot;,
       x = &quot;Month&quot;, 
       y = &quot;Number of Crossings&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;state&#39;, &#39;month&#39; (override with `.groups` argument)</code></pre>
<p><img src="code-for-final-project_files/figure-html/potential_visuals-3.png" width="672" /></p>
<pre class="r"><code>## For this one, we can have a drop down option for state. will show just for New York now
border_crossing_df %&gt;%
  filter(state == &quot;New York&quot;) %&gt;% 
  group_by(month, year) %&gt;%  
  summarize(mean_value = mean(value)) %&gt;%
  ggplot(aes(x = month , y = mean_value, color = as.factor(year))) + 
  geom_point() + 
  geom_line() + 
  theme(legend.position = &quot;bottom&quot;) + 
  scale_x_continuous(limits = c(1,12), breaks = c(1:12)) +
  labs(title = &quot;Average Number of Border Crossings by Year in New York&quot;,
       x = &quot;Month&quot;, 
       y = &quot;Number of Crossings&quot;, 
       color = &quot;Year&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;month&#39; (override with `.groups` argument)</code></pre>
<p><img src="code-for-final-project_files/figure-html/potential_visuals-4.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
