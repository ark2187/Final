---
title: "Crossings Vehicles"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r include=FALSE}
library(tidyverse)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 10,
  fig.asp = .6,
  fig.height = 8,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "right"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


```{r include=FALSE}
border_crossing_df = readRDS(file = "border_crossing_df_clean.rds")

round_exp <- function(val){
  exp(val) %>% round()
}
  
```

# Vehicle Trends
```{r message = FALSE}
vehicles_monthly <-
  border_crossing_df %>%
  filter(vehicle == "Vehicles") %>%
  group_by(border, measure, month) %>%
  summarize(num = sum(value))

vehicles_monthly %>%
  mutate(measure = as.factor(measure), border = as.factor(border)) %>%
  ungroup() %>%
  ggplot(aes(x = month, y = log(num), group = measure , color = measure)) +
  geom_point() +
  geom_line() +
  facet_grid(~border) +
  theme(legend.position = "bottom") + 
  scale_x_continuous(limits = c(1,12), breaks = c(1:12)) +
  scale_y_continuous(trans = scales::log_trans(base = exp(1))) +
  labs(title = "Monthly Trends of Vehicle Border Crossings from 2000 to 2018",
       x = "Month", 
       y = "Ln Number of Crossings", 
       color = "Vehicle Type")
```

More buses at US Mexico border- seasonal trends in US Canadian border buses and personal vehicles. 

```{r message = FALSE}
vehicles_yearly <-
  border_crossing_df %>%
  group_by(vehicle, year) %>%
  summarize(num = sum(value))

vehicles_yearly %>%
  ggplot(aes(x = year, y = log(num), color = as.factor(vehicle))) +
  geom_point(size = 2, alpha = 0.5) +
  geom_line(size = 1.5, alpha = 0.5) +
  theme(legend.position = "bottom") + 
  scale_x_continuous(limits = c(2000,2018), breaks = c(2000:2018)) +
  scale_y_continuous(trans = scales::log_trans(base = exp(1))) +
  labs(title = "Yearly Trend of Vehicle and Non-Vehicle Border Crossings from 2000 to 2018",
       x = "Year", 
       y = "Ln Number of Crossings", 
       color = "Crossing Type",
       caption = "Number of crossings was log-transformed. Non-vehicle types include pedestrian and vehicle passenger counts.")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The border-crossing trends look similar for both vehicle and non-vehicles, which include pedestrian crossings and passengers. We see a substantial dip in the data around 2008-2012 when President Obama serves his first term. This was a time known for a rise in deportations and lack of immigration reform due to Republican opposition. In his second term, Obama was able to accomplish more broader legislation including the Deferred Action for Childhood Arrivals (DACA) in 2012.

```{r message=FALSE}
mexico_yearly <- 
  border_crossing_df %>%
  filter(border == "US-Mexico Border") %>%
  group_by(vehicle, year) %>%
  summarize(num = sum(value)) %>%
  ggplot(aes(x = year, y = log(num), color = as.factor(vehicle))) +
  geom_point(size = 2, alpha = 0.5) +
  geom_line(size = 1.5, alpha = 0.5) +
  theme(legend.position = "bottom") + 
  scale_x_continuous(limits = c(2000,2018), breaks = c(2000:2018)) +
  scale_y_continuous(trans = scales::log_trans(base = exp(1))) +
  labs(title = "Yearly Trend of Vehicle and Non-Vehicle US-Mexico Border Crossings from 2000 to 2018",
       x = "Year", 
       y = "Ln Number of Crossings",
       color = "Crossing Type",
       caption = "Number of crossings was log-transformed. Non-vehicle types include pedestrian and vehicle passenger counts.")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

canada_yearly <- 
  border_crossing_df %>%
  filter(border == "US-Canada Border") %>%
  group_by(vehicle, year) %>%
  summarize(num = sum(value)) %>%
  ggplot(aes(x = year, y = log(num), color = as.factor(vehicle))) +
  geom_point(size = 2, alpha = 0.5) +
  geom_line(size = 1.5, alpha = 0.5) +
  theme(legend.position = "none") +
  scale_x_continuous(limits = c(2000,2018), breaks = c(2000:2018)) +
  scale_y_continuous(trans = scales::log_trans(base = exp(1))) +
  labs(title = "Yearly Trend of Vehicle and Non-Vehicle US-Canada Border Crossings from 2000 to 2018",
       x = "Year", 
       y = "Ln Number of Crossings") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

canada_yearly / mexico_yearly
```


# Personal Vehicles

```{r eval=FALSE}
personal_vehicle_df <-
  border_crossing_df
```

change in commercial travel

empty trucks?



 